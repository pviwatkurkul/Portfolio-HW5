<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Me</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./styles/vars.css">
    <link rel="stylesheet" href="./styles/index.css">
    <link rel="stylesheet" href="./styles/contact.css">
 
</head>
<body>
    <nav>
        <button title="light/dark switch" class="themeButton">
            <svg id="theme-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="currentColor"><circle cx="12" cy="12" r="8.5" stroke="#fff5fcfa" stroke-width="1"/><path fill="#fff5fcfa" d="M16.243 7.757a6 6 0 1 0-8.486 8.486L12 12z"/></g></svg>
        </button>
        <a href="https://www.linkedin.com/in/purich-viwatkurkul/">
            <svg role="img" id="linkedIn" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <title>LinkedIn Logo Hyperlink</title>
                <path fill="currentColor" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37z"/>
            </svg>
        </a>
        <a href="https://github.com/pviwatkurkul">
            <svg role="img" id="github" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <title>Github Logo Hyperlink</title>
                <path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
        </a>
        <a href="./index.html">
            <button id="home-button">Home</button>
        </a>
    </nav>
    <div class="mainContainer">
        <main>

            <h1>
                Let's Chat
            </h1>
            <p>
                Have an exciting opportunity or just want to leave a nice message? I would love to know about you and how I can be of your service!
            </p>
            <h2>Email</h2>
            <p>
                <a id="email-link" href="mailto:purichv123@gmail.com">
                    purichv123@gmail.com
                </a>
            </p>
        </main>

        <aside>
            <form id="contact-form" action="https://httpbin.org/post" autocomplete="on" method="POST" target="_blank" novalidate>
                <input type="hidden" name="possible_bot" value="true" hidden>

                <input type="hidden" name="form_errors" id="form_errors" value="">

                <label class="inputTitle required" for="name">Name</label>
                <input id="name" type="text" name="name" minlength="1"
                maxlength="50" placeholder="Your Name" autocomplete="on" autofocus required pattern="^[a-zA-Z0-9_]*$"/>

                <label class="inputTitle required" for="email">Email</label>
                <input id="email" type="email" name="email" placeholder="example@email.com" autocomplete="on" minlength="1" maxlength="50" 
                pattern="[^@\s]+@[^@\s]+\.[^@\s]+" required/>
                
                <label class="inputTitle required" for="message">Message</label>
                <textarea id="message" name="message" placeholder="Leave a message!" minlength="1" maxlength="2000" required></textarea>
                <output id="info" for="email" form="contact-form"></output>

                <button type="submit" id="form-submit">Submit</button>

                <output id="error" for="message" form="contact-form"></output>
                <output id="error2" for="email" form="contact-form"></output>
                <output id="error3" for="name" form="contact-form"></output>

            </form>

        </aside>
    </div>

    <noscript>Light Mode will not work with JavaScript off! Please turn on JavaScript to enable functionality</noscript>

    <script>
        document.addEventListener("DOMContentLoaded", () =>{

            let toggleTheme = document.getElementById("theme-mode-button");
            let nameInput = document.getElementById("name");
            let emailInput = document.getElementById("email");
            let messageInput = document.getElementById("message");

            let messageError = document.getElementById("error");
            let emailError = document.getElementById("error2");
            let nameError = document.getElementById("error3");
            const hiddenErrors = document.getElementById("form_errors");

            let outputInfo = document.getElementById("info");
            let form = document.getElementById("contact-form");

            nameInput.addEventListener("input", (e) =>{
                validateName(e);
            });

            messageInput.addEventListener("input", () =>{
                info()
                validateMessage();
            });

            emailInput.addEventListener("input", (e) =>{
                validateEmail(e);
            })

            form.addEventListener("submit", (e) =>{

                const form_errors = [];

                if (!validateName()) {
                    form_errors.push({
                    field: "name",
                    errorMessage: nameInput.validationMessage
                    });
                }
                if (!validateEmail()) {
                    form_errors.push({
                    field: "email",
                    errorMessage: emailInput.validationMessage
                    });
                }
                if (!validateMessage()) {
                    form_errors.push({
                    field: "message",
                    errorMessage: messageInput.validationMessage
                    });
                }


                hiddenErrors.value = JSON.stringify(form_errors);

            });

            let fadeTimeout;
            function validateName(e){
                if(!nameInput.checkValidity()){
                    nameError.textContent=`Illegal Character!`;

                    if (fadeTimeout) {
                        clearTimeout(fadeTimeout);
                    }

                    fadeTimeout = setTimeout(() =>{
                        nameError.classList.add('fade-out');
                    },2000);
                    return false
                }
                else if(nameInput.checkValidity()){
                    nameError.textContent="";
                    if (fadeTimeout) {
                        clearTimeout(fadeTimeout);
                    }
                    nameError.classList.remove('fade-out')
                    return true;
                }             
            }

            function validateEmail(e){
                if(!emailInput.checkValidity()){
                    emailError.textContent=`Email Invalid!`;
                    return false
                }
                else if(emailInput.checkValidity()){
                    emailError.textContent="";
                    return true;
                }                
            }

            function validateMessage(){
                let maxLength = 2000;
                let message = messageInput.value.trim();
                if (message.length == 0){
                    messageError.textContent = `Cannot submit empty message!`;
                    return false;
                }
                else if (message.length >= maxLength){
                    messageError.textContent = `Message too long! Please shorten.`;
                    return false;
                }
                else{
                    messageError.textContent = "";
                    return true;
                }
            };

            function info(){
                let maxLength = 2000;
                let message = messageInput.value.trim();

                if (message.length < maxLength){
                    outputInfo.textContent = `${(maxLength - message.length)}/${maxLength}`;
                    if((maxLength - message.length) <= (maxLength / 4)){
                        outputInfo.style.color = "red";
                    }
                    else if((maxLength - message.length) <= (maxLength/2)){
                        outputInfo.style.color= "yellow";
                    }
                    return true;
                }
                else{
                    outputInfo.textContent = "";
                    return false;
                }
            };

            let toggleButton = document.getElementsByClassName("themeButton")[0];
            const htmlElement = document.documentElement;

            const storedTheme = localStorage.getItem("theme") || "default";
            htmlElement.setAttribute("data-theme", storedTheme);

            toggleButton.addEventListener("click", () => {
                const currentTheme = htmlElement.getAttribute("data-theme");
                const newTheme = currentTheme === "default" ? "light" : "default";

                htmlElement.setAttribute("data-theme", newTheme);
                localStorage.setItem("theme", newTheme);
            });
         });


    </script>
</body>
</html>